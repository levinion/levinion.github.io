## 如何开始

设计一门新（解释型）语言至少包括几个环节：词法分析、语法分析、虚拟机。其中，词法分析的产物是 token 流，语法分析产生中间表示（如字节码），虚拟机则负责利用中间表示进行代码的解释和执行。

## 词法分析
所以我们需要做的第一步是词法分析。token 即是组成语言的最小单元，包括变量或常量甚至函数的名称、符号、关键字等。这一部分交由词法分析器完成，它的工作很简单：字符串解析。

## 语法分析
通过词法分析，我们得到了 token 流。语法分析的工作即是在 token 流的基础上，生成几张表（包括常量表、全局变量表、局部变量表等），以及控制执行流程的字节码。

字节码由几部分构成：

- 行为标记：如加载常量（LoadConst）、调用函数（Call）、栈内复制（Move）等
- 参数：主要由两个 u8 构成，一个表示栈的位置，一个表示在表中的位置，均由索引表示。

在语法分析过程中，我们通常同步执行以下两个步骤：

- 添加表
- 生成字节码

## 虚拟机
虚拟机的工作仅仅是依次执行字节码。它通过字节码将变量、常量或函数加载到栈上，并且进行调用。