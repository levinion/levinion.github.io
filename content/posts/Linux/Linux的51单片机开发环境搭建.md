---
title: "Linuxçš„51å•ç‰‡æœºå¼€å‘ç¯å¢ƒæ­å»º"
created: 2022-11-27 23:21:39
---

å› ä¸ºæœ€è¿‘æ–°å¼€äº†ä¸€é—¨ 51 å•ç‰‡æœºè¯¾ç¨‹ï¼Œæ‰€ä»¥æäº†å°å•ç‰‡æœºå¼€å‘æ¿æ¥ç©ã€‚ä¼ ç»Ÿçš„å•ç‰‡æœºå¼€å‘ç¯å¢ƒåŸºæœ¬ä¸Šéƒ½æ˜¯ Windows+Keilï¼Œè€Œ Keil çš„ç¼–è¾‘å™¨åˆæ˜¾å¾—è½åã€‚å¦‚æœä½ ä¹Ÿæƒ³è¦è„±ç¦» Windows å’Œ Keil é‚£ç§ä¼ ç»Ÿçš„å¼€å‘ç”Ÿæ€ï¼Œæ‹¥æŠ± Linux çš„å¼€å‘ç¯å¢ƒçš„è¯ï¼Œä¸å¦¨å°è¯• PlatformIOã€‚

## 1 ğŸˆPlatformIO

PlatformIO æ˜¯ä¸€ä¸ªç‰©è”ç½‘å¼€å‘çš„å¼€æºç”Ÿæ€ç³»ç»Ÿï¼Œæ”¯æŒè·¨å¹³å°çš„å¼€å‘å’Œè°ƒè¯•ã€‚æˆ‘å¹³æ—¶ä½¿ç”¨ VSCode ä½œä¸ºä¸»åŠ›ç¼–è¾‘å™¨ï¼›PlatformIO æ’ä»¶å¯¹ VSCode çš„æ”¯æŒå¾ˆå¥½ã€‚å½“ç„¶ï¼Œå¦‚æœä½ ä½¿ç”¨å…¶ä»–ç¼–è¾‘å™¨æˆ– ideï¼Œé‚£ä¹Ÿå½“ç„¶æ²¡é—®é¢˜ï¼›PlatfromIO åœ¨ Clionã€QTã€Vim ç­‰ä¸»æµè½¯ä»¶ä¸­å‡ç”±ç›¸å…³æ’ä»¶æ”¯æŒã€‚è¿™é‡Œä»¥ VSCode ä¸ºä¾‹ï¼š

1. é¦–å…ˆå®‰è£… PlatformIO IDE æ’ä»¶

![](https://ghproxy.com/github.com/levinion/blog-pic/blob/main/img/Pasted%20image%2020221127234938.png)

2. æ‰“å¼€ PlatfromIO IDE é¦–é¡µ

![](https://ghproxy.com/github.com/levinion/blog-pic/blob/main/img/Pasted%20image%2020221128000736.png)

3. ä» Platfroms ä¸­æœç´¢ Intel MCS-51 (8051) è¿›è¡Œä¸‹è½½
   
   ![image-20221128004948062](https://ghproxy.com/github.com/levinion/blog-pic/blob/main//img/image-20221128004948062.png)

4. ç‚¹å‡»æ–°å»ºé¡¹ç›®
   
   ![image-20221128005430885](https://ghproxy.com/github.com/levinion/blog-pic/blob/main//img/image-20221128005430885.png)

5. å¡«å†™é¡¹ç›®åç§°ï¼›é€‰æ‹© STC89C52RCï¼›è¿›å…¥ä¸‹ä¸€æ­¥

![image-20221128005630955](https://ghproxy.com/github.com/levinion/blog-pic/blob/main//img/image-20221128005630955.png)

6. include æ–‡ä»¶å¤¹ä¸‹å­˜æ”¾é¡¹ç›®éœ€è¦çš„å¤´æ–‡ä»¶ï¼›ä¸»ç¨‹åºæ”¾åœ¨ src ç›®å½•ä¸‹ï¼›platformio.ini æ˜¯ PlatformIOçš„é…ç½®æ–‡ä»¶ï¼›

![image-20221128010233061](https://ghproxy.com/github.com/levinion/blog-pic/blob/main/img/image-20221128010233061.png)

## 2 ğŸ”°hello world

æ­£å¦‚æ¯ç§è¯­è¨€çš„å…¥é—¨ç¨‹åºä¸€å®šæ˜¯ hello world é‚£æ ·ï¼Œå­¦ä¹  51 å•ç‰‡æœºçš„åˆæ¬¡å®è·µå¿…å®šæ˜¯ç‚¹äº® led ç¯ã€‚è®©æˆ‘ä»¬å‘ src ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š

```c
//main.c
#include "8051.h"
#define LED P1_0

void main(){
    LED = 0;
}
```

ä½ å¯èƒ½ä¼šæ³¨æ„åˆ°è¿™ä¸ªç¨‹åºå’Œä½ åœ¨ Keil ä¸­è§åˆ°çš„å¹¶ä¸å®Œå…¨ä¸€æ ·ï¼ˆä¹Ÿå°±æ˜¯è¯´å’Œå¤§å¤šæ•°çš„æ•™ç¨‹å¹¶ä¸ç›¸åŒï¼‰ï¼Œä½†æ²¡æœ‰ä»»ä½•å…³ç³»ï¼›PlatformIO ä½¿ç”¨çš„ç¼–è¯‘å™¨æ˜¯ sdccï¼Œå› æ­¤å’Œ Keil å…·æœ‰ä¸åŒçš„æŒ‡ä»¤ï¼Œæ¯”å¦‚å®šä¹‰ç«¯å£æ—¶ä½¿ç”¨ â€œ \_ â€ ï¼Œè€Œä¸æ˜¯ â€œ \^ â€ ï¼›åˆæ¯”å¦‚ä½¿ç”¨å®å®šä¹‰è€Œä¸æ˜¯â€œ sbit â€...

## 3 âš¾ç¡®è®¤ä¸²å£é©±åŠ¨

ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒLinux è‡ªå¸¦ä¸²å£é©±åŠ¨ã€‚ä½†ä¸ºäº†ç¡®ä¿é©±åŠ¨åˆ‡å®å­˜åœ¨ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆå½“ç„¶æ˜¯åœ¨å·²è¿æ¥å•ç‰‡æœºçš„æƒ…å†µä¸‹ï¼‰

```bash
sudo dmesg | grep tty
```

![image-20221128012501552](https://ghproxy.com/github.com/levinion/blog-pic/blob/main/img/image-20221128012501552.png)

å½“çœ‹åˆ°æ–¹æ¡†ä¸­ä¿¡æ¯è¡¨æ˜é©±åŠ¨å·²å®‰è£…ã€‚ä¸‡ä¸€ï¼ˆ<s>çœŸçš„ä¼šæœ‰è¿™ä¸ªä¸‡ä¸€å—ï¼Ÿ</s>ï¼‰æ²¡èƒ½çœ‹åˆ°æ­¤æ¡æ¶ˆæ¯ï¼Œè¯·å…ˆå®‰è£…é©±åŠ¨ï¼Œä¸è¦å¾€ä¸‹èµ°ã€‚

## 4 ğŸ”¥æ„å»ºå’Œçƒ§å½•

![image-20221128014316253](https://ghproxy.com/github.com/levinion/blog-pic/blob/main/img/image-20221128014316253.png)

Platform IO ä¸­å·²ç»äº‹å…ˆé¢„ç•™å¥½äº†æ„å»ºå’Œçƒ§å½•é€‰é¡¹ï¼Œä¸€èˆ¬æ¥è¯´æˆ‘ä»¬åªéœ€è¦é¼ æ ‡ç‚¹ç‚¹å°±è¡Œï¼Œä½†è¿˜æ˜¯ç¨å¾®äº†è§£ä¸€ä¸‹å…¶ä¸­åŸç†ã€‚

Platform IO æ„å»ºè¿‡ç¨‹ä½¿ç”¨çš„ç¼–è¯‘å™¨ï¼Œæ­£å¦‚æˆ‘ä»¬ä¹‹å‰æ‰€è¯´ï¼Œæ˜¯ sdccã€‚å…¶å…¨ç§°æ˜¯ Small Device C Compilerï¼Œè¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ GPL æˆæƒçš„å¼€æºå·¥å…·é›†ï¼›è¿™ä¹Ÿæ„å‘³ç€æˆ‘ä»¬èƒ½å¤Ÿæ¯«æ— é¡¾è™‘åœ°å°†å…¶æŠ•å…¥åˆ°ç”Ÿäº§ä¸­ï¼ˆç‚¹åæ‰¹è¯„æŸ K å­—å¼€å¤´çš„è½¯ä»¶ï¼‰ã€‚å…¶æŒ‡ä»¤ä¸ Keil ç¨æœ‰ä¸åŒã€‚

çƒ§å½•ä½¿ç”¨çš„æ˜¯ stcgalã€‚stcgal æ˜¯ STC Windows è½¯ä»¶çš„å…¨åŠŸèƒ½å¼€æºæ›¿ä»£å“ï¼›å®ƒæ”¯æŒå¹¿æ³›çš„ MCUï¼Œéå¸¸ä¾¿æºï¼Œé€‚åˆè‡ªåŠ¨åŒ–ã€‚ä½¿ç”¨å‘½ä»¤è¡Œè¿è¡Œçš„æŒ‡ä»¤å¦‚ä¸‹ï¼š

```bash
stcgal -P stc89 -p /dev/ttyUSB0 .pio/build/STC89C52RC/firmware.hex
```

å…¶ä¸­ `-P` æŒ‡å®šå•ç‰‡æœºçš„å‹å·ï¼Œ`-p` æŒ‡å®šä¸²å£ï¼Œæ­¤å¤„å¡«å†™ä¸Šé¢æŸ¥æ‰¾åˆ°çš„ä¸²å£åç§°ã€‚ï¼ˆæœ‰æ—¶èƒ½å¤Ÿè‡ªåŠ¨æ‰¾åˆ°ä¸²å£å’Œå•ç‰‡æœºå‹å·ï¼Œå› æ­¤ä¸æ˜¯å¿…å¡«é¡¹ï¼‰

æˆ‘æ‰€ä½¿ç”¨çš„æ˜¯æŸä¸­ç§‘æŠ€çš„ STC89C52 å¼€å‘æ¿ï¼Œå·²çŸ¥åœ¨ä½¿ç”¨ Platform IO è‡ªå¸¦çš„ stcgal è¿›è¡Œçƒ§å½•ä¼šå¡åœ¨ `Cycling power: done` ï¼Œæ— æ³•ç»§ç»­è¿›è¡Œçƒ§å½•ã€‚æ®åˆ¤æ–­ï¼Œæ˜¯æœªæŒ‡å®šå¼€å‘æ¿å‹å·ã€‚å› æ­¤ä½¿ç”¨æŒ‡ä»¤è¿›è¡Œçƒ§å½•ï¼›å‡ºäºå·æ‡’çš„åŸå› ï¼Œåœ¨ `~/.zshrc` ä¸­æ·»åŠ ä¸€æ¡åˆ«åï¼š

```bash
alias stc89="stcgal -P stc89 -t 24000 .pio/build/STC89C52RC/firmware.hex"
```

è¾“å…¥æŒ‡ä»¤åï¼ŒæŒ‰æç¤ºæ‰‹åŠ¨æ–­ç”µä¸Šç”µ

![image-20221128021600659](https://ghproxy.com/github.com/levinion/blog-pic/blob/main/img/image-20221128021600659.png)

å½“çœ‹åˆ°â€œ Disconnected! â€æ—¶è¡¨æ˜çƒ§å½•å®Œæ¯•

![image-20221128021716933](https://ghproxy.com/github.com/levinion/blog-pic/blob/main/img/image-20221128021716933.png)

> è‹¥æç¤ºä¸²å£ Permission denied ï¼Œå°è¯•è¿è¡Œ `sudo chmod 777 /dev/ttyUSB0` å¢åŠ æƒé™ã€‚

## ğŸ“–å‚è€ƒ

1. [stcgal - STC MCU ISP é—ªå­˜å·¥å…·](https://gitee.com/mirrors/stcgal)
2. [Linuxæ“ä½œç³»ç»Ÿæ­å»º51å•ç‰‡æœºå¼€å‘ç¯å¢ƒï¼ˆå›½äº§æ¡Œé¢æ“ä½œç³»ç»Ÿdeepinï¼‰](https://blog.csdn.net/RYMCU/article/details/111350775)
3. [å…³äº stcgal çƒ§å†™ STC89C52 çš„é—®é¢˜](https://blog.csdn.net/Narukara/article/details/120623921#:~:text=%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95)
